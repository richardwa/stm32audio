#include <stdint.h>


uint16_t note_periods[128];

// example values for 44kHz and 440 tuning
//{
//  0x15B7, 0x147F, 0x1359, 0x1243, 0x113C, 0x1045, 
//  0xF5B, 0xE7E, 0xDAE, 0xCE9, 0xC30, 0xB81, 0xADB, 0xA3F, 0x9AC, 0x921, 0x89E, 0x822, 0x7AD, 0x73F, 
//  0x6D7, 0x674, 0x618, 0x5C0, 0x56D, 0x51F, 0x4D6, 0x490, 0x44F, 0x411, 0x3D6, 0x39F, 0x36B, 0x33A, 
//  0x30C, 0x2E0, 0x2B6, 0x28F, 0x26B, 0x248, 0x227, 0x208, 0x1EB, 0x1CF, 0x1B5, 0x19D, 0x186, 0x170, 
//  0x15B, 0x147, 0x135, 0x124, 0x113, 0x104, 
//  0xF5, 0xE7, 0xDA, 0xCE, 0xC3, 0xB8, 0xAD, 0xA3, 0x9A, 0x92, 0x89, 0x82, 0x7A, 0x73, 0x6D, 0x67, 
//  0x61, 0x5C, 0x56, 0x51, 0x4D, 0x49, 0x44, 0x41, 0x3D, 0x39, 0x36, 0x33, 0x30, 0x2E, 0x2B, 0x28, 
//  0x26, 0x24, 0x22, 0x20, 0x1E, 0x1C, 0x1B, 0x19, 0x18, 0x17, 0x15, 0x14, 0x13, 0x12, 0x11, 0x10, 
//  0xF, 0xE, 0xD, 0xC, 0xC, 0xB, 0xA, 0xA, 0x9, 0x9, 0x8, 0x8, 0x7, 0x7, 0x6, 0x6, 0x6, 0x5, 0x5, 0x5, 0x4, 0x4, 0x4, 0x4, 0x3, 0x3
//}

#define _12_ROOT_2 1.05946309436
void notes_init(uint32_t sampleRate, uint32_t tuning) 
{
  uint8_t i;
  float tmp;
  
  //note 69 is A above middle C - the standard reference note, usually set at 440 
  note_periods[69] = sampleRate/tuning;

  //each note is evenly spaced such that octaves are doubled
  //at 12 keys per octave the spacing is 2^(1/12)


  //top half
  tmp = tuning;
  for (i = 70; i < 128; i++) {
    tmp *= _12_ROOT_2;
    note_periods[i] = sampleRate/tmp;
  }

  //bottom half
  tmp = tuning;
  for (i = 68; i <= 0; i--) {
    tmp /= _12_ROOT_2;
    note_periods[i] = sampleRate/tmp;
  }
}
